(function(e){var i=e(window);var t={};var o=[];var a=[];var n=false;var s=false;var l;var p=null;var r=null;var d=null;var f=null;var c="_open";var u="_close";var v=null;var h={_init:function(i){var t=e(i);var n=t.data("popupoptions");a[i.id]=false;o[i.id]=0;if(!t.data("popup-initialized")){t.attr("data-popup-initialized","true");h._initonce(i)}if(n.autoopen){setTimeout(function(){h.show(i,0)},0)}},_initonce:function(i){var t=e("body");var o;var a=$el.data("popupoptions");f=parseInt(t.css("margin-right"),10);if(a.type=="tooltip"){a.background=false;a.scrolllock=false}if(a.scrolllock){var n;var s;if(typeof l==="undefined"){n=e('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body");s=n.children();l=s.innerWidth()-s.height(99).innerWidth();n.remove()}}if(!$el.attr("id")){$el.attr("id","j-popup-"+parseInt(Math.random()*1e8))}$el.addClass("popup_content");t.prepend(i);$el.wrap('<div id="'+i.id+'_wrapper" class="popup_wrapper" />');o=e("#"+i.id+"_wrapper");o.css({opacity:0,visibility:"hidden",position:"absolute",overflow:"auto"});$el.css({opacity:0,visibility:"hidden",display:"inline-block"});if(a.setzindex&&!a.autozindex){o.css("z-index","2001")}if(!a.outline){$el.css("outline","none")}if(a.transition){$el.css("transition",a.transition);o.css("transition",a.transition)}e(i).attr("aria-hidden",true);if(a.background&&!e("#"+i.id+"_background").length){var p='<div id="'+i.id+'_background" class="popup_background"></div>';t.prepend(p);var r=e("#"+i.id+"_background");r.css({opacity:0,visibility:"hidden",backgroundColor:a.color,position:"fixed",top:0,right:0,bottom:0,left:0});if(a.setzindex&&!a.autozindex){r.css("z-index","2000")}if(a.transition){r.css("transition",a.transition)}}if(a.type=="overlay"){$el.css({textAlign:"left",position:"relative",verticalAlign:"middle"});o.css({position:"fixed",top:0,right:0,left:0,bottom:0,textAlign:"center"});o.append('<div class="popup_align" />');e(".popup_align").css({display:"inline-block",verticalAlign:"middle",height:"100%"})}$el.attr("role","dialog");var d=a.openelement?a.openelement:"."+i.id+c;e(d).each(function(i,t){e(t).attr("data-popup-ordinal",i);if(!e(t).attr("id")){e(t).attr("id","open_"+parseInt(Math.random()*1e8,10))}});if(!($el.attr("aria-labelledby")||$el.attr("aria-label"))){$el.attr("aria-labelledby",e(d).attr("id"))}e(document).on("click",d,function(t){if(!$el.data("popup-visible")){var o=e(this).data("popup-ordinal");setTimeout(function(){h.show(i,o)},0);t.preventDefault()}});var v=a.closeelement?a.closeelement:"."+i.id+u;e(document).on("click",v,function(e){h.hide(i);e.preventDefault()});if(a.detach){$el.hide().detach()}else{o.hide()}},show:function(t,c){var u=e(t);if(u.data("popup-visible"))return;if(!u.data("popup-initialized")){h._init(t)}u.attr("data-popup-initialized","true");var g=e("body");var m=u.data("popupoptions");var y=e("#"+t.id+"_wrapper");var _=e("#"+t.id+"_background");b(t,c,m.beforeopen);a[t.id]=c;if(m.detach){y.prepend(t);u.show()}else{y.show()}setTimeout(function(){y.css({visibility:"visible",opacity:1});e("html").addClass("popup_visible").addClass("popup_visible_"+t.id);u.addClass("popup_content_visible")},20);u.css({visibility:"visible",opacity:1});if(m.scrolllock){g.css("overflow","hidden");if(g.height()>i.height()){g.css("margin-right",f+l)}}setTimeout(function(){if(!n){if(m.keepfocus){e(document).on("focusin",p)}if(m.blur){e(document).on("click",r)}if(m.escape){e(document).on("keydown",d)}}if(!n){n=true}else{s=true}},0);u.data("popup-visible",true);h.reposition(t,c);if(m.background){_.css({visibility:"visible",opacity:m.opacity});setTimeout(function(){_.css({opacity:m.opacity})},0)}v=document.activeElement;if(m.keepfocus){u.attr("tabindex",-1);setTimeout(function(){if(m.focuselement){e(m.focuselement).focus()}else{u.focus()}},m.focusdelay);p=function(e){var i=document.getElementById(t.id);if(!i.contains(e.target)){e.stopPropagation();i.focus()}}}if(m.autozindex){var k=document.getElementsByTagName("*");var w=k.length;var $=0;for(var z=0;z<w;z++){var x=e(k[z]).css("z-index");if(x!=="auto"){x=parseInt(x);if($<x){$=x}}}o[t.id]=$;if(o[t.id]>0){y.css({zIndex:o[t.id]+2})}if(m.background){if(o[t.id]>0){e("#"+t.id+"_background").css({zIndex:o[t.id]+1})}}}if(m.blur){r=function(i){if(!e(i.target).parents().andSelf().is("#"+t.id)){h.hide(t)}}}if(m.escape){d=function(e){if(e.keyCode==27&&u.data("popup-visible")){h.hide(t)}}}e(m.pagecontainer).attr("aria-hidden",true);u.attr("aria-hidden",false);y.one("transitionend",function(){b(t,c,m.opentransitionend)});b(t,c,m.onopen)},hide:function(i){var t=e("body");var o=e(i);var l=o.data("popupoptions");var c=e("#"+i.id+"_wrapper");var u=e("#"+i.id+"_background");o.data("popup-visible",false);if(s){e("html").removeClass("popup_visible_"+i.id);s=false}else{e("html").removeClass("popup_visible").removeClass("popup_visible_"+i.id);n=false}o.removeClass("popup_content_visible");if(l.scrolllock){setTimeout(function(){t.css({overflow:"visible","margin-right":f})},10)}if(l.blur){e(document).off("click",r)}if(l.keepfocus){e(document).off("focusin",p);setTimeout(function(){if(e(v).is(":visible")){v.focus()}},0)}if(l.escape){e(document).off("keydown",d)}c.css({visibility:"hidden",opacity:0});o.css({visibility:"hidden",opacity:0});if(l.background){u.css({visibility:"hidden",opacity:0})}o.one("transitionend",function(e){if(!o.data("popup-visible")){if(l.detach){o.hide().detach()}else{c.hide()}}if(!l.notransitiondetach){b(i,a[i.id],l.closetransitionend)}});if(l.notransitiondetach){if(l.detach){o.hide().detach()}else{c.hide()}}e(l.pagecontainer).attr("aria-hidden",false);o.attr("aria-hidden",true);b(i,a[i.id],l.onclose)},toggle:function(e,i){if($el.data("popup-visible")){h.hide(e)}else{setTimeout(function(){h.show(e,i)},0)}},reposition:function(i,t){var o=e(i);var a=o.data("popupoptions");var n=e("#"+i.id+"_wrapper");var s=e("#"+i.id+"_background");t=t||0;if(a.type=="tooltip"){n.css({position:"absolute"});var l=a.openelement?a.openelement:"."+i.id+c;var p=e(l+'[data-popup-ordinal="'+t+'"]');var r=p.offset();if(a.horizontal=="right"){n.css("left",r.left+p.outerWidth()+a.offsetleft)}else if(a.horizontal=="leftedge"){n.css("left",r.left+p.outerWidth()-p.outerWidth()+a.offsetleft)}else if(a.horizontal=="left"){n.css("right",e(window).width()-r.left-a.offsetleft)}else if(a.horizontal=="rightedge"){n.css("right",e(window).width()-r.left-p.outerWidth()-a.offsetleft)}else{n.css("left",r.left+p.outerWidth()/2-o.outerWidth()/2-parseFloat(o.css("marginLeft"))+a.offsetleft)}if(a.vertical=="bottom"){n.css("top",r.top+p.outerHeight()+a.offsettop)}else if(a.vertical=="bottomedge"){n.css("top",r.top+p.outerHeight()-o.outerHeight()+a.offsettop)}else if(a.vertical=="top"){n.css("bottom",e(window).height()-r.top-a.offsettop)}else if(a.vertical=="topedge"){n.css("bottom",e(window).height()-r.top-o.outerHeight()-a.offsettop)}else{n.css("top",r.top+p.outerHeight()/2-o.outerHeight()/2-parseFloat(o.css("marginTop"))+a.offsettop)}}else if(a.type=="overlay"){if(a.horizontal){n.css("text-align",a.horizontal)}else{n.css("text-align","center")}if(a.vertical){o.css("vertical-align",a.vertical)}else{o.css("vertical-align","middle")}}}};var b=function(i,o,a){var n=t.openelement?t.openelement:"."+i.id+c;var s=e(n+'[data-popup-ordinal="'+o+'"]');if(typeof a=="function"){a(s)}};e.fn.popup=function(i){return this.each(function(){$el=e(this);if(typeof i==="object"){var o=e.extend({},e.fn.popup.defaults,i);$el.data("popupoptions",o);t=$el.data("popupoptions");h._init(this)}else if(typeof i==="string"){if(!$el.data("popupoptions")){$el.data("popupoptions",e.fn.popup.defaults);t=$el.data("popupoptions")}h[i].call(this,this)}else{if(!$el.data("popupoptions")){$el.data("popupoptions",e.fn.popup.defaults);t=$el.data("popupoptions")}h._init(this)}})};e.fn.popup.defaults={type:"overlay",autoopen:false,background:true,color:"black",opacity:"0.5",horizontal:"center",vertical:"middle",offsettop:0,offsetleft:0,escape:true,blur:true,setzindex:true,autozindex:false,scrolllock:false,keepfocus:true,focuselement:null,focusdelay:50,outline:false,pagecontainer:null,detach:false,openelement:null,closeelement:null,transition:null,notransitiondetach:false,beforeopen:function(){},onclose:function(){},onopen:function(){},opentransitionend:function(){},closetransitionend:function(){}}})(jQuery);